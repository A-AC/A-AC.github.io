<!DOCTYPE html>
<html>
<head>
  <style>
    #container {
      width: 600px;
      height: 400px;
      position: relative;
      border: 1px solid black;
    }
    .link {
      position: absolute;
      background-color: gray;
      height: 10px;
      transform-origin: top left;
    }
    .joint {
      position: absolute;
      background-color: black;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      transform-origin: center;
    }
    #end-effector {
      position: absolute;
      background-color: red;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      transform-origin: center;
    }
  </style>
</head>
<body>
  <div id="container">
    <div class="link" id="link1"></div>
    <div class="joint" id="joint1"></div>
    <div class="link" id="link2"></div>
    <div class="joint" id="joint2"></div>
    <div class="link" id="link3"></div>
    <div class="joint" id="joint3"></div>
    <div class="link" id="link4"></div>
    <div class="joint" id="joint4"></div>
    <div id="end-effector"></div>
    <div id="base"></div>
  </div>

  <script>
    // Constants for arm dimensions
    const linkLength = 100;
    const jointRadius = 10;

    // Get references to all the arm elements
    const container = document.getElementById('container');
    const links = document.querySelectorAll('.link');
    const joints = document.querySelectorAll('.joint');
    const endEffector = document.getElementById('end-effector');
    const base = document.getElementById('base');

    // Calculate the center position of the container
    const containerRect = container.getBoundingClientRect();
    const containerCenterX = containerRect.width / 2;
    const containerCenterY = containerRect.height / 2;

    // Add mousemove event listener to the container
    container.addEventListener('mousemove', handleMouseMove);

    function handleMouseMove(event) {
      // Get the mouse coordinates relative to the container
      const mouseX = event.clientX - containerRect.left;
      const mouseY = event.clientY - containerRect.top;

      // Calculate the angles using inverse kinematics
      const angles = calculateInverseKinematics(mouseX - containerCenterX, mouseY - containerCenterY);

      // Update the arm configuration
      updateArmConfiguration(angles);
    }

    function calculateInverseKinematics(targetX, targetY) {
      // Calculate the distance and angle between the origin and the target point
      const distance = Math.sqrt(targetX * targetX + targetY * targetY);
      const baseAngle = Math.atan2(targetY, targetX);

      // Calculate the remaining angles using law of cosines
      const cosAngle3 = (distance * distance - linkLength * linkLength - linkLength * linkLength) / (2 * linkLength * linkLength);
      const angle3 = Math.acos(cosAngle3);

      const cosAngle2 = (distance * distance + linkLength * linkLength - linkLength * linkLength) / (2 * distance * linkLength);
      const angle2 = Math.acos(cosAngle2);

      // Calculate the angles for the second and fourth joints
      const angle1 = baseAngle;
      const angle4 = Math.PI - angle2 - angle3;

      // Return the angles as an array
      return [angle1, angle2, angle3, angle4];
    }

    function updateArmConfiguration(angles) {
      let prevX = containerCenterX;
      let prevY = containerCenterY;

      // Update the positions and rotations of the arm elements
      for (let i = 0; i < joints.length; i++) {
        const x = prevX + linkLength * Math.cos(calculateSumOfAngles(angles, i));
        const y = prevY + linkLength * Math.sin(calculateSumOfAngles(angles, i));

        joints[i].style.transform = `translate(${x - jointRadius}px, ${y - jointRadius}px)`;
        links[i].style.width = linkLength + "px";
        links[i].style.transform = `translate(${prevX}px, ${prevY}px) rotate(${angles[i]}rad)`;

        prevX = x;
        prevY = y;
      }

      // Update the end effector position
      const endEffectorX = prevX - jointRadius;
      const endEffectorY = prevY - jointRadius;
      endEffector.style.transform = `translate(${endEffectorX}px, ${endEffectorY}px)`;
    }

    function calculateSumOfAngles(angles, index) {
      // Calculate the sum of angles up to the specified index
      let sum = 0;
      for (let i = 0; i <= index; i++) {
        sum += angles[i];
      }
      return sum;
    }
  </script>
</body>
</html>
